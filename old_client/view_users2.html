<style>

</style>

<script>
    function getUsers() {
        console.log("Get users from mysql database via fetch !");

       
        //post body
        let postData = {
            method: 'POST',
            headers: {
                Accept: 'application/json',
                'Content-Type': 'application/json',
            },
            body: JSON.stringify("OK"),
        };

        //fetch
        let host = "http://127.0.0.1:5659";
        let link = "/read_from_database2";

        fetch(host + link, postData)
            .then((resp) => {
                console.log(" >>> first then happen");
                //return resp.json(); 
                return resp.text();
            })
            .then((response) => {
                console.log("Fetch response happen !");
                

                console.log("Database data : " + JSON.parse(response));
                var obj = JSON.parse(response);
                console.log(obj.body.db);

                var myarray = obj.body.db;


                for (var element in myarray) {
                     console.log(" ++++++> " + myarray[element] );
                }
                

                 //JSON.parse(response).body.db.forEach((v) => console.log(v))

                
                document.getElementById("answer_field").innerHTML = response;

                 //var  a =  JSON.stringify(response.msg);
                // var b = JSON.stringify(response.db);

                // document.getElementById("answer_field").innerHTML = a;

            })
            .catch(function (error_msg) {
                // error if connection problem happens 
                console.log("Fetch error : " + error_msg);
                 document.getElementById("answer_field").innerHTML = "<div align='center'><font color='red'><h1>Node Server is down ! </h1></font></div>";
            })

    }

</script>

<html>

<title> View all users from database </title>

<body onload="getUsers()">
    <button onclick="getUsers()"> Refresh data</button>
    <br /><br />
    <p id="answer_field"></p>
</body>

</html>